<link rel="stylesheet" href="/includes/navbar.css" />
<script>
	document.addEventListener("DOMContentLoaded", function () {
		const tooltipTriggerList = document.querySelectorAll(
			'[data-bs-toggle="tooltip"]'
		);
		const tooltipList = [...tooltipTriggerList].map(
			(tooltipTriggerEl) => new bootstrap.Tooltip(tooltipTriggerEl)
		);
	});
</script>
<nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top border-bottom">
	<div class="container-fluid">
		<a class="navbar-brand" href="/listings"
			><i class="fa-solid fa-anchor"
				><span id="navbarMainTag"
					>C<span id="navbarMainaTagSmallText">omfort</span>N<span
						id="navbarMainaTagSmallText"
						>est</span
					></span
				></i
			></a
		>
		<button
			class="navbar-toggler btn btn-outline-dark"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarNavAltMarkup"
			aria-controls="navbarNavAltMarkup"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<i class="fa-solid fa-bars"></i>
		</button>
		<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
			<div class="navbar-nav ms-auto relative-search-bar">
				<form
					class="d-flex"
					role="search"
					method="GET"
					action="/listings/search"
				>
					<input
						class="form-control me-2 search-input"
						type="search"
						name="location"
						placeholder="Search Nest's by Destinations"
					/>
					<button class="btn btn-outline-danger search-btn" type="submit">
						<i class="fa-solid fa-magnifying-glass"></i>Search
					</button>
				</form>
			</div>
			<div class="navbar-nav ms-auto">
				<div class="row d-flex mt-lg-0 mt-3">
					<div class="dropdown col-6">
						<button
							type="button"
							class="btn btn-outline-danger dropdown-toggle"
							data-bs-toggle="dropdown"
							aria-expanded="false"
						>
							<i class="fa-regular fa-user me-2"></i><% if (currentUser) { %>
							<span><%= currentUser.username %></span>
							<% } else { %>
							<span>anonymous</span>
							<% } %>
						</button>
						<ul class="dropdown-menu">
							<% if(!currentUser){ %>
							<a
								class="nav-link dropdown-item ms-2"
								aria-current="page"
								href="/signup"
								><b>SignUp</b></a
							>
							<a class="nav-link dropdown-item ms-2" href="/login"
								><b>Login</b></a
							>
							<% } %> <% if(currentUser){ %>
							<a class="nav-link" href="/logout"><b>Logout</b></a>
							<% } %>
						</ul>
					</div>
					<div class="col-3">
						<a
							class="btn btn-outline-danger relative-icon"
							href="/listings/new"
							data-bs-toggle="tooltip"
							data-bs-placement="bottom"
							data-bs-title="Nest your Home"
							data-bs-custom-class="custom-tooltip"
							><i class="fa-solid fa-house-chimney-medical"></i
						></a>
					</div>
					<div class="col-3">
						<button class="btn btn-outline-dark" id="darkToggle">
							<i class="fa-solid fa-moon"></i>
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</nav>

<script>
	function setTheme(theme) {
		document.documentElement.setAttribute("data-bs-theme", theme);
		localStorage.setItem("theme", theme);
		const darkToggle = document.getElementById("darkToggle");
		const icon = darkToggle.querySelector("i");
		icon.className = theme === "dark" ? "fa-solid fa-sun" : "fa-solid fa-moon";
	}

	// Initialize theme on page load
	document.addEventListener("DOMContentLoaded", () => {
		const savedTheme = localStorage.getItem("theme") || "light";
		setTheme(savedTheme);
	});

	// Toggle theme on button click
	document.getElementById("darkToggle").addEventListener("click", () => {
		const currentTheme = document.documentElement.getAttribute("data-bs-theme");
		const newTheme = currentTheme === "dark" ? "light" : "dark";
		setTheme(newTheme);
	});
</script>
